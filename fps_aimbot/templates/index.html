<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPS压枪宏控制面板</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .status-item {
            text-align: center;
        }
        .status-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #007bff;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-warning {
            background-color: #ffc107;
            color: black;
        }
        .configs {
            margin: 20px 0;
        }
        .config-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border: 1px solid #ddd;
            margin: 5px 0;
            border-radius: 5px;
        }
        .config-active {
            background-color: #e6f7ff;
            border-color: #007bff;
        }
        .weapon-icon {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>FPS压枪宏控制面板</h1>
        
        <div class="status">
            <div class="status-item">
                <div>压枪宏状态</div>
                <div id="status-value" class="status-value">关闭</div>
            </div>
            <div class="status-item">
                <div>当前配置</div>
                <div id="config-value" class="status-value">1 - AKM</div>
            </div>
            <button id="toggle-btn" class="btn btn-primary">开启/关闭</button>
        </div>
        
        <div class="configs">
            <h2>配置列表</h2>
            <div id="configs-list">
                <!-- 配置项将通过JavaScript动态加载 -->
            </div>
        </div>
        
        <div>
            <h2>使用说明</h2>
            <ul>
                <li>使用 ALT+0 开启/关闭压枪宏</li>
                <li>使用 ALT+1-9 切换配置</li>
                <li>按下鼠标左键激活压枪</li>
            </ul>
        </div>
    </div>

    <script>
        // 获取状态
        function getStatus() {
            fetch('/api/status')
                .then(response => response.json())
                .then(data => {
                    // 更新状态显示
                    document.getElementById('status-value').textContent = data.is_enabled ? '开启' : '关闭';
                    document.getElementById('status-value').style.color = data.is_enabled ? '#28a745' : '#dc3545';
                    
                    // 更新当前配置显示
                    const currentConfig = data.configs[data.current_config];
                    if (currentConfig) {
                        document.getElementById('config-value').textContent = 
                            `${data.current_config} - ${currentConfig.name}`;
                    }
                    
                    // 更新配置列表
                    updateConfigList(data.configs, data.current_config);
                });
        }
        
        // 更新配置列表
        function updateConfigList(configs, currentConfig) {
            const configsList = document.getElementById('configs-list');
            configsList.innerHTML = '';
            
            for (const [key, config] of Object.entries(configs)) {
                const configItem = document.createElement('div');
                configItem.className = `config-item ${key == currentConfig ? 'config-active' : ''}`;
                configItem.innerHTML = `
                    <div>
                        <img src="/static/icons/${config.icon}" alt="${config.name}" class="weapon-icon">
                        <strong>${key} - ${config.name}</strong>
                    </div>
                    <button class="btn btn-warning" onclick="switchConfig(${key})">切换到此配置</button>
                `;
                configsList.appendChild(configItem);
            }
        }
        
        // 切换压枪宏状态
        document.getElementById('toggle-btn').addEventListener('click', function() {
            fetch('/api/toggle', {method: 'POST'})
                .then(response => response.json())
                .then(data => {
                    // 更新状态显示
                    document.getElementById('status-value').textContent = data.is_enabled ? '开启' : '关闭';
                    document.getElementById('status-value').style.color = data.is_enabled ? '#28a745' : '#dc3545';
                });
        });
        
        // 切换配置
        function switchConfig(configNum) {
            fetch('/api/switch_config', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({config: configNum})
            })
            .then(response => response.json())
            .then(data => {
                // 更新当前配置显示
                const currentConfig = data.configs[data.current_config];
                if (currentConfig) {
                    document.getElementById('config-value').textContent = 
                        `${data.current_config} - ${currentConfig.name}`;
                }
                
                // 更新配置列表
                updateConfigList(data.configs, data.current_config);
            });
        }
        
        // 定期更新状态
        setInterval(getStatus, 1000);
        
        // 页面加载时获取初始状态
        getStatus();
    </script>
</body>
</html>